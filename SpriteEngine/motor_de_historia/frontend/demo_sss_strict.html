<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azraell - Ficha Primordial (Secured)</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Metamorphous&display=swap"
        rel="stylesheet">
    <style>
        /* BASE THEME (Standard) but with SSS Overrides */
        :root {
            --bg-dark: #0a0a0f;
            --panel-dark: #111;
            --paper: #e3dac9;
            --paper-texture: url('https://www.transparenttextures.com/patterns/aged-paper.png');
            --ink: #1a1a1a;

            /* SSS Tier Colors (Overrides standard Gold/Brown) */
            --tier-sss-primary: #800080;
            /* Deep Purple */
            --tier-sss-secondary: #FFD700;
            /* Gold */
            --tier-sss-glow: #9932CC;
            /* Neon Purple Glow */

            --gold: var(--tier-sss-secondary);
            --gold-bright: #ffffaa;
            --blood: #8a0b0b;
            --accent: #4b0082;
            /* Indigo/Purple accent instead of brown */

            --tag-conflict: #8a3b3b;
            --tag-combat: #3b5b8a;
            --tag-roleplay: #8a3b86;
        }

        body {
            background-color: var(--bg-dark);
            margin: 0;
            padding: 40px 20px;
            font-family: 'Crimson Text', serif;
            color: var(--ink);
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .rpg-sheet {
            width: 100%;
            max-width: 1100px;
            background-color: var(--paper);
            background-image: var(--paper-texture);
            box-shadow: 0 0 80px rgba(128, 0, 128, 0.4);
            display: grid;
            grid-template-columns: 340px 1fr;
            min-height: 1200px;
            position: relative;
            overflow: hidden;
            border-radius: 4px;
            border: 2px solid var(--tier-sss-secondary);
        }

        /* SIDEBAR (STATS) */
        .sidebar {
            background-color: var(--panel-dark);
            color: #ccc;
            padding: 30px 25px;
            border-right: 4px solid var(--tier-sss-secondary);
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        /* AVATAR (Premium Style) */
        .avatar-container {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            border-radius: 50%;
            background: #050505;
            position: relative;
            transition: all 0.5s ease;
            cursor: pointer;
            overflow: hidden;
            border: 4px solid #333;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
        }

        .avatar-container.legendary {
            border-color: var(--tier-sss-primary);
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
        }

        .avatar-container.legendary::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                linear-gradient(45deg, transparent 48%, var(--tier-sss-secondary) 50%, transparent 52%),
                linear-gradient(-45deg, transparent 48%, var(--tier-sss-secondary) 50%, transparent 52%);
            background-size: 200% 200%;
            opacity: 0.6;
            pointer-events: none;
            mix-blend-mode: overlay;
        }

        .avatar-container:hover .upload-overlay {
            opacity: 1;
        }

        .upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
            color: #fff;
            font-family: 'Cinzel';
            font-size: 0.8rem;
            text-align: center;
            z-index: 10;
        }

        .avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* TRAUMA / RISK BAR */
        .tension-wrapper {
            margin-top: 5px;
            text-align: center;
        }

        .tension-label-mini {
            font-family: 'Cinzel';
            font-size: 0.7rem;
            color: var(--blood);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .risk-meter {
            height: 6px;
            background: #222;
            border-radius: 3px;
            border: 1px solid #444;
            overflow: hidden;
            position: relative;
        }

        .risk-fill {
            height: 100%;
            width: 25%;
            background: linear-gradient(90deg, #555, #b00, #ff0);
        }

        /* ECONOMY */
        .economy-box {
            text-align: center;
            border: 1px solid var(--tier-sss-secondary);
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            margin-bottom: 10px;
        }

        /* SCARS LOG (New Section) */
        .scars-section {
            border-top: 1px solid #444;
            padding-top: 15px;
        }

        .scars-title {
            color: var(--blood);
            font-family: 'Cinzel';
            text-align: center;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .scar-slot {
            border: 1px dashed #555;
            background: rgba(255, 255, 255, 0.02);
            padding: 8px;
            margin-bottom: 5px;
            font-size: 0.8rem;
            color: #888;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .scar-slot:hover {
            border-color: var(--tier-sss-secondary);
            color: #ccc;
        }

        .scar-bonus {
            font-weight: bold;
            font-size: 0.7rem;
            background: #333;
            padding: 2px 5px;
            border-radius: 3px;
        }

        /* PERKS (Locked Logic) */
        .soul-perk {
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid var(--tier-sss-secondary);
            padding: 10px;
            margin-bottom: 12px;
        }

        .locked-perk {
            opacity: 0.6;
            filter: grayscale(0.8);
            border-left-color: #555;
            position: relative;
        }

        .locked-msg {
            display: block;
            font-size: 0.7rem;
            color: var(--blood);
            font-weight: bold;
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* STATS */
        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            justify-items: center;
        }

        .stat-medallion {
            position: relative;
            width: 80px;
            height: 90px;
            background: linear-gradient(135deg, #222, #111);
            border: 1px solid #555;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 8px;
            transition: transform 0.2s;
        }

        .stat-medallion:hover {
            border-color: var(--tier-sss-secondary);
            transform: scale(1.05);
        }

        .stat-icon {
            width: 20px;
            height: 20px;
            fill: var(--tier-sss-secondary);
            margin-bottom: 2px;
        }

        .stat-value-big {
            font-family: 'Cinzel';
            font-size: 1.6rem;
            color: #fff;
            font-weight: 700;
            line-height: 1;
        }

        .stat-name-tiny {
            font-size: 0.6rem;
            color: #888;
            text-transform: uppercase;
        }

        .stat-mod-seal {
            position: absolute;
            bottom: -8px;
            background: var(--tier-sss-primary);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel';
            font-weight: bold;
            font-size: 0.8rem;
            border: 2px solid var(--tier-sss-secondary);
        }

        /* MAIN CONTENT */
        .main-content {
            padding: 40px 50px;
            position: relative;
        }

        .tier-stamp {
            display: inline-block;
            background: var(--tier-sss-secondary);
            color: #000;
            padding: 2px 10px;
            border-radius: 4px;
            font-family: 'Cinzel';
            font-weight: 900;
            font-size: 0.8rem;
            margin-bottom: 10px;
            border: 1px solid #000;
        }

        h1 {
            font-family: 'Cinzel';
            font-size: 4rem;
            color: var(--ink);
            margin: 0;
            line-height: 1;
        }

        .sub-header {
            font-family: 'Metamorphous';
            font-size: 1.3rem;
            color: var(--tier-sss-primary);
            margin-top: 5px;
            font-style: italic;
        }

        .quote-box {
            border-left: 4px solid var(--tier-sss-secondary);
            background: linear-gradient(to right, rgba(128, 0, 128, 0.1), transparent);
            padding: 15px 20px;
            margin: 25px 0;
            font-family: 'Cinzel';
            font-size: 1.2rem;
            color: #222;
            font-style: italic;
        }

        /* INVENTORY GRID */
        .inv-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .inv-item {
            border: 1px solid #ccc;
            padding: 8px;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
        }

        .legendary-item {
            border: 1px solid var(--tier-sss-secondary);
            background: linear-gradient(to right, rgba(255, 215, 0, 0.1), transparent);
            color: #440044;
            font-weight: bold;
        }

        /* Matrix & Timeline */
        .matrix-box {
            background: rgba(128, 0, 128, 0.05);
            border: 2px solid var(--tier-sss-primary);
            padding: 25px;
            margin: 30px 0;
        }

        .matrix-row {
            display: flex;
            margin-bottom: 15px;
            align-items: baseline;
        }

        .matrix-label {
            font-weight: bold;
            font-variant: small-caps;
            color: var(--tier-sss-primary);
            font-size: 1rem;
            width: 140px;
        }

        .matrix-text {
            font-style: italic;
            color: #333;
            flex: 1;
        }

        .timeline-item {
            margin-bottom: 12px;
            border-left: 3px solid var(--tier-sss-secondary);
            padding-left: 15px;
        }

        .timeline-year {
            font-family: 'Cinzel';
            font-weight: bold;
            color: var(--tier-sss-primary);
        }

        .download-btn {
            display: block;
            width: fit-content;
            margin: 30px auto 0;
            background: var(--ink);
            color: var(--paper);
            border: 2px solid var(--tier-sss-secondary);
            padding: 15px 30px;
            font-family: 'Cinzel';
            cursor: pointer;
            transition: 0.3s;
        }

        .download-btn:hover {
            background: var(--tier-sss-primary);
            color: #fff;
        }

        @media (max-width: 900px) {
            .rpg-sheet {
                grid-template-columns: 1fr;
                border: none;
            }

            .sidebar {
                border-right: none;
                border-bottom: 4px solid var(--tier-sss-secondary);
                padding: 20px;
            }

            .stats-container {
                grid-template-columns: repeat(3, 1fr);
            }

            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>

<body onload="initSecureSystem()">

    <div class="rpg-sheet">
        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="avatar-container legendary" onclick="triggerUpload()">
                <div id="avatar-placeholder"
                    style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:#FFD700; font-size:3rem;">
                    â—ˆ
                </div>
                <!-- Placeholder for dynamic image if user provides one -->
                <div class="upload-overlay">
                    <span style="font-size:1.5rem">ğŸ“·</span>
                    <span>Registrar Rostro</span>
                </div>
            </div>
            <input type="file" id="avatar-input" accept="image/*" style="display:none"
                onchange="encodeImageFileAsURL(this)">

            <!-- TENSION BAR -->
            <div class="tension-wrapper" title="Nivel de tensiÃ³n narrativa.">
                <div class="tension-label-mini">TENSIÃ“N INTERIOR</div>
                <div class="risk-meter">
                    <div class="risk-fill"></div>
                </div>
                <div style="font-size:0.6rem; color:#666; margin-top:3px;">
                    Estado: <span style="color:#aaa">Estable</span> | Siguiente: <span style="color:#d88">FrenesÃ­
                        (Requiere DaÃ±o)</span>
                </div>
            </div>

            <div class="economy-box">
                <div style="font-size:0.6rem; color:#888;">CAPITAL CÃ“SMICO</div>
                <div style="font-family:'Cinzel'; font-size:1.4rem; color:var(--tier-sss-secondary);">2,500 <span
                        style="font-size:0.8rem">GP</span></div>
            </div>

            <!-- HISTORIAL DE CONFLICTOS -->
            <div class="scars-section">
                <div class="scars-title">âš”ï¸ HISTORIAL DE BATALLAS</div>

                <div class="scar-slot filled" title="Cicatriz inicial por el ritual de invocaciÃ³n">
                    <div style="display:flex; flex-direction:column;">
                        <span style="color:#ddd; font-weight:bold;">IntervenciÃ³n Divina</span>
                        <span style="font-size:0.65rem;">(Cicatriz de Nacimiento)</span>
                    </div>
                    <span class="scar-bonus">+2 VOL</span>
                </div>

                <div class="scar-slot" onclick="alert('Registra aquÃ­ tu prÃ³ximo trauma grave para desbloquear poder.')">
                    <span>[Espacio para Trauma]</span>
                    <span style="opacity:0.5">???</span>
                </div>
            </div>

            <div class="stats-container">
                <!-- Data populated by JS security core -->
                <!-- STR -->
                <div class="stat-medallion">
                    <svg class="stat-icon" viewBox="0 0 24 24">
                        <path d="M3,2 L21,20 L19,22 L16,14 L10,8 L2,6 L3,2 Z" />
                    </svg>
                    <span class="stat-value-big" id="stat-str">--</span>
                    <span class="stat-name-tiny">Fuerza</span>
                    <div class="stat-mod-seal" id="mod-str">--</div>
                </div>
                <!-- DEX -->
                <div class="stat-medallion">
                    <svg class="stat-icon" viewBox="0 0 24 24">
                        <path d="M12,2 L12,22 M2,12 L22,12 M12,2 Z" />
                    </svg>
                    <span class="stat-value-big" id="stat-dex">--</span>
                    <span class="stat-name-tiny">Destreza</span>
                    <div class="stat-mod-seal" id="mod-dex">--</div>
                </div>
                <!-- CON -->
                <div class="stat-medallion">
                    <svg class="stat-icon" viewBox="0 0 24 24">
                        <path
                            d="M12,2 L4,5 L4,11 C4,16.55 7.46,21.57 12,23 C16.54,21.57 20,16.55 20,11 L20,5 L12,2 Z" />
                    </svg>
                    <span class="stat-value-big" id="stat-con">--</span>
                    <span class="stat-name-tiny">Const.</span>
                    <div class="stat-mod-seal" id="mod-con">--</div>
                </div>
                <!-- INT -->
                <div class="stat-medallion">
                    <svg class="stat-icon" viewBox="0 0 24 24">
                        <path d="M12,2 C7.03,2 3,6.03 3,11 C3,16.55 12,22 12,22 Z" />
                    </svg>
                    <span class="stat-value-big" id="stat-int">--</span>
                    <span class="stat-name-tiny">Intel.</span>
                    <div class="stat-mod-seal" id="mod-int">--</div>
                </div>
                <!-- WIS -->
                <div class="stat-medallion">
                    <svg class="stat-icon" viewBox="0 0 24 24">
                        <path d="M12,2 C6.48,2 2,6.48 2,12 C2,17.52 6.48,22 12,22 Z" />
                    </svg>
                    <span class="stat-value-big" id="stat-wis">--</span>
                    <span class="stat-name-tiny">Sabid.</span>
                    <div class="stat-mod-seal" id="mod-wis">--</div>
                </div>
                <!-- CHA -->
                <div class="stat-medallion">
                    <svg class="stat-icon" viewBox="0 0 24 24">
                        <path d="M12,2 L2,7 L2,17 L12,22 L22,17 L22,7 L12,2 Z" />
                    </svg>
                    <span class="stat-value-big" id="stat-cha">--</span>
                    <span class="stat-name-tiny">Carisma</span>
                    <div class="stat-mod-seal" id="mod-cha">--</div>
                </div>
            </div>

            <!-- SKILLS (Locked) -->
            <div class="resonance-section" style="margin-top:20px; border-top:1px solid #444; padding-top:15px;">
                <div class="resonance-title">âœ¨ DONES MÃTICOS (SSS)</div>

                <!-- LOCKED Legendary Perk -->
                <div class="soul-perk locked-perk">
                    <span style="color:#aaa; font-weight:bold;">Omnisciencia Limitada</span>
                    <span class="locked-msg">ğŸ”’ Requiere: 1 Cicatriz Mayor</span>
                </div>

                <!-- Active Perk -->
                <div class="soul-perk">
                    <span class="perk-name">Aura de SoberanÃ­a</span>
                    <div style="font-size:0.8rem; color:#ccc; margin-top:5px;">
                        NPCs de bajo nivel no pueden iniciar hostilidades.
                    </div>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <div class="char-header">
                <!-- TIER SET DYNAMICALLY -->
                <div class="tier-stamp" id="tier-badge">LOADING...</div>
                <h1 id="char-name">Undisclosed</h1>
                <div class="sub-header" id="char-archetype">Entidad CÃ³smica Â· Caminante de Planos Â· Edad Eterna Â· Tono:
                    Solemne</div>
            </div>

            <div class="quote-box">
                "La entropÃ­a no es un error en el sistema; es la Ãºnica certeza que tienen los mortales... y mi Ãºnica
                herramienta."
            </div>

            <h2>BiografÃ­a: El Testigo del VacÃ­o</h2>
            <!-- Rich Narrative with Tags -->
            <p>
                <span class="dm-tag dm-roleplay"
                    style="background:#220022; color:#d88; border-color:#505; padding:2px 8px; border-radius:4px; font-weight:bold; font-size:0.75rem; margin-right:5px; border:1px solid;">ğŸŒŒ
                    Origen</span>
                Azraell existÃ­a antes de que los dioses aprendieran a mentir. Despertado por el colapso de la primera
                estrella, vaga entre dimensiones observando el ascenso y caÃ­da de imperios estelares. No es un hÃ©roe ni
                un villano; es una <strong>fuerza de la naturaleza</strong> encarnada.
            </p>
            <p>
                <span class="dm-tag dm-conflict"
                    style="background:#300; color:#f55; border-color:#800; padding:2px 8px; border-radius:4px; font-weight:bold; font-size:0.75rem; margin-right:5px; border:1px solid;">ğŸ©¸
                    El Trauma</span>
                Recientemente, un ritual fallido de la Orden del Loto Negro lo atÃ³ a una forma semimortal. Ha
                descubierto dolor fÃ­sico y lÃ­mites por primera vez.
            </p>

            <!-- PSYCHO MATRIX -->
            <div class="matrix-box">
                <div class="matrix-row">
                    <span class="matrix-label">La Mentira</span>
                    <span class="matrix-text">"Soy un prisionero en este cuerpo."</span>
                </div>
                <div class="matrix-row">
                    <span class="matrix-label">La Herida</span>
                    <span class="matrix-text">La SensaciÃ³n de Finitud.</span>
                </div>
                <div class="matrix-row">
                    <span class="matrix-label">El Deseo</span>
                    <span class="matrix-text">Romper los 7 Sellos.</span>
                </div>
            </div>

            <h2>ğŸ’ Inventario Legendario (Vinculado)</h2>
            <div class="inv-section" id="inventory-grid">
                <!-- Dynamically Populated -->
            </div>

            <h2>ğŸ“– BitÃ¡cora de Crisis</h2>
            <div style="font-size:0.8rem; color:#666; font-style:italic; margin-bottom:15px;">
                (Registro de momentos donde el HP bajÃ³ del 10%)
            </div>

            <div id="crisis-log">
                <div class="timeline-item" style="border-left-color:var(--blood);">
                    <div class="timeline-year" style="color:var(--blood)">DÃ­a 1</div>
                    <div class="timeline-content" contenteditable="true">
                        IntentÃ© contener una explosiÃ³n de manÃ¡ sin protecciÃ³n. Me costÃ³ la sensibilidad en la mano
                        izquierda.
                        <br><strong style="font-size:0.8rem; color:#d88">>> DESBLOQUEO: RESISTENCIA TÃ‰RMICA</strong>
                    </div>
                </div>
            </div>

            <button class="download-btn" onclick="saveProgress()">
                ğŸ’¾ CRISTALIZAR DATOS (Guardar HTML)
            </button>
        </div>
    </div>

    <!-- PROTECTED DATA PAYLOAD (Simulated Encryption) -->
    <!-- Content is Base64 String - Decoded on Load to prevent casual HTML editing of Stats -->
    <script id="protected-core" type="application/json">
        "eyJuYW1lIjoiQXpyYWVsbCIsInRpZXIiOiJQUklNT1JESUFMIiwic3RhdHMiOnsic3RyIjoxOCwiZGV4IjoyMCwiY29uIjoyMiwiaW50IjoyNSwid2lzIjoyNSwiY2hhIjozMH0sImWZmHkcyI6WzQsNSw2LDcsNywxMF0sImludmVudG9yeSI6WyJfw58gRXNwYWRhIGRlIEV2ZW50b3MiLCJfw68gTWFudG8gZGVsIFZhY8O0IiwiXHVEODNDXHVEQzhEIEFuaWxsbyBkZSBTaW5ndWxhcmlkYWQiLCJcdUQ4M0RXHVEQzRDIEdyaW1vcmlvIGRlbCBPcmlnZW4iLCJcdUQ4M0RXHVDEğŸ©¸ Vial de Sangre Antigua","\uD83D\uDD11 Llave de la Torre"]}
    </script>

    <script>
        // --- TRANSLATION DATA ---
        const TRANSLATIONS = {
            es: {
                title: "Azraell - Ficha Primordial (Secured)",
                tension_label: "TENSIÃ“N INTERIOR",
                tension_status: "Estado: <span style='color:#aaa'>Estable</span> | Siguiente: <span style='color:#d88'>FrenesÃ­ (Requiere DaÃ±o)</span>",
                capital_label: "CAPITAL CÃ“SMICO",
                scars_title: "âš”ï¸ HISTORIAL DE BATALLAS",
                scar_1: "IntervenciÃ³n Divina",
                scar_1_sub: "(Cicatriz de Nacimiento)",
                scar_empty: "[Espacio para Trauma]",
                stats: ["Fuerza", "Destreza", "Const.", "Intel.", "Sabid.", "Carisma"],
                dones_title: "âœ¨ DONES MÃTICOS (SSS)",
                perk_locked_name: "Omnisciencia Limitada",
                perk_locked_req: "ğŸ”’ Requiere: 1 Cicatriz Mayor",
                perk_active_name: "Aura de SoberanÃ­a",
                perk_active_desc: "NPCs de bajo nivel no pueden iniciar hostilidades.",
                inv_title: "ğŸ’ Inventario Legendario (Vinculado)",
                crisis_title: "ğŸ“– BitÃ¡cora de Crisis",
                crisis_subtitle: "(Registro de momentos donde el HP bajÃ³ del 10%)",
                btn_save: "ğŸ’¾ CRISTALIZAR DATOS (Guardar HTML)",
                // Content
                char_name: "Azraell",
                tier: "PRIMORDIAL",
                archetype: "Entidad CÃ³smica Â· Caminante de Planos Â· Edad Eterna Â· Tono: Solemne",
                quote: "\"La entropÃ­a no es un error en el sistema; es la Ãºnica certeza que tienen los mortales... y mi Ãºnica herramienta.\"",
                bio_title: "BiografÃ­a: El Testigo del VacÃ­o",
                bio_origin_tag: "ğŸŒŒ Origen",
                bio_text: "Azraell existÃ­a antes de que los dioses aprendieran a mentir. Despertado por el colapso de la primera estrella, vaga entre dimensiones observando el ascenso y caÃ­da de imperios estelares. No es un hÃ©roe ni un villano; es una <strong>fuerza de la naturaleza</strong> encarnada.",
                bio_trauma_tag: "ğŸ©¸ El Trauma",
                bio_trauma_text: "Recientemente, un ritual fallido de la Orden del Loto Negro lo atÃ³ a una forma semimortal. Ha descubierto dolor fÃ­sico y lÃ­mites por primera vez.",
                matrix: [
                    { label: "La Mentira", text: "\"Soy un prisionero en este cuerpo.\"" },
                    { label: "La Herida", text: "La SensaciÃ³n de Finitud." },
                    { label: "El Deseo", text: "Romper los 7 Sellos." }
                ],
                crisis_log: "IntentÃ© contener una explosiÃ³n de manÃ¡ sin protecciÃ³n. Me costÃ³ la sensibilidad en la mano izquierda.<br><strong style='font-size:0.8rem; color:#d88'>>> DESBLOQUEO: RESISTENCIA TÃ‰RMICA</strong>",
                inventory_items: ["âš”ï¸ Espada de Eventos", "ğŸ§¥ Manto del VacÃ­o", "ğŸ’ Anillo de Singularidad", "ğŸ“œ Grimorio del Origen", "ğŸ©¸ Vial de Sangre Antigua", "ğŸ”‘ Llave de la Torre"]
            },
            en: {
                title: "Azraell - Primordial Sheet (Secured)",
                tension_label: "INNER TENSION",
                tension_status: "Status: <span style='color:#aaa'>Stable</span> | Next: <span style='color:#d88'>Frenzy (Requires Damage)</span>",
                capital_label: "COSMIC CAPITAL",
                scars_title: "âš”ï¸ BATTLE HISTORY",
                scar_1: "Divine Intervention",
                scar_1_sub: "(Birth Scar)",
                scar_empty: "[Trauma Slot]",
                stats: ["Strength", "Dexterity", "Const.", "Intel.", "Wisdom", "Charisma"],
                dones_title: "âœ¨ MYTHIC GIFTS (SSS)",
                perk_locked_name: "Limited Omniscience",
                perk_locked_req: "ğŸ”’ Requires: 1 Major Scar",
                perk_active_name: "Aura of Sovereignty",
                perk_active_desc: "Low-level NPCs cannot initiate hostilities.",
                inv_title: "ğŸ’ Legendary Inventory (Bound)",
                crisis_title: "ğŸ“– Crisis Log",
                crisis_subtitle: "(Record of moments where HP dropped below 10%)",
                btn_save: "ğŸ’¾ CRYSTALLIZE DATA (Save HTML)",
                // Content
                char_name: "Azraell",
                tier: "PRIMORDIAL",
                archetype: "Cosmic Entity Â· Planeswalker Â· Eternal Age Â· Tone: Solemn",
                quote: "\"Entropy is not a bug in the system; it is the only certainty mortals have... and my only tool.\"",
                bio_title: "Biography: The Void Witness",
                bio_origin_tag: "ğŸŒŒ Origin",
                bio_text: "Azraell existed before gods learned to lie. Awakened by the collapse of the first star, he wanders between dimensions observing the rise and fall of stellar empires. He is neither hero nor villain; he is a <strong>force of nature</strong> incarnate.",
                bio_trauma_tag: "ğŸ©¸ The Trauma",
                bio_trauma_text: "Recently, a failed ritual by the Order of the Black Lotus bound him to a semi-mortal form. He has discovered physical pain and limits for the first time.",
                matrix: [
                    { label: "The Lie", text: "\"I am a prisoner in this body.\"" },
                    { label: "The Wound", text: "The Sensation of Finitude." },
                    { label: "The Desire", text: "Break the 7 Seals." }
                ],
                crisis_log: "Tried to contain a mana explosion without protection. Cost me sensitivity in my left hand.<br><strong style='font-size:0.8rem; color:#d88'>>> UNLOCK: THERMAL RESISTANCE</strong>",
                inventory_items: ["âš”ï¸ Event Sword", "ğŸ§¥ Void Mantle", "ğŸ’ Singularity Ring", "ğŸ“œ Grimoire of Origin", "ğŸ©¸ Vial of Ancient Blood", "ğŸ”‘ Tower Key"]
            },
            jp: {
                title: "ã‚¢ã‚ºãƒ©ã‚¨ãƒ« - å§‹æºã®ã‚·ãƒ¼ãƒˆ (ä¿è­·)",
                tension_label: "å†…éƒ¨ã®ç·Šå¼µ",
                tension_status: "çŠ¶æ…‹: <span style='color:#aaa'>å®‰å®š</span> | æ¬¡: <span style='color:#d88'>ç‹‚ä¹± (ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒå¿…è¦)</span>",
                capital_label: "å®‡å®™è³‡æœ¬",
                scars_title: "âš”ï¸ æˆ¦é—˜å±¥æ­´",
                scar_1: "ç¥ã®ä»‹å…¥",
                scar_1_sub: "(èª•ç”Ÿã®å‚·)",
                scar_empty: "[ãƒˆãƒ©ã‚¦ãƒã‚¹ãƒ­ãƒƒãƒˆ]",
                stats: ["ç­‹åŠ›", "æ•æ·æ€§", "è€ä¹…åŠ›", "çŸ¥åŠ›", "åˆ¤æ–­åŠ›", "é­…åŠ›"],
                dones_title: "âœ¨ ç¥è©±çš„æ©æµ (SSS)",
                perk_locked_name: "é™å®šçš„ãªå…¨çŸ¥",
                perk_locked_req: "ğŸ”’ å¿…è¦æ¡ä»¶: é‡å‚·1ã¤",
                perk_active_name: "ä¸»æ¨©ã®ã‚ªãƒ¼ãƒ©",
                perk_active_desc: "ä½ãƒ¬ãƒ™ãƒ«ã®NPCã¯æ•µå¯¾è¡Œå‹•ã‚’é–‹å§‹ã§ããªã„ã€‚",
                inv_title: "ğŸ’ ä¼èª¬ã®ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒª (çµåˆ)",
                crisis_title: "ğŸ“– å±æ©Ÿãƒ­ã‚°",
                crisis_subtitle: "(HPãŒ10%ã‚’ä¸‹å›ã£ãŸç¬é–“ã®è¨˜éŒ²)",
                btn_save: "ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚’çµæ™¶åŒ– (HTMLä¿å­˜)",
                // Content
                char_name: "ã‚¢ã‚ºãƒ©ã‚¨ãƒ«",
                tier: "ãƒ—ãƒªãƒ¢ãƒ¼ãƒ‡ã‚£ã‚¢ãƒ«",
                archetype: "å®‡å®™çš„å­˜åœ¨ Â· ãƒ—ãƒ¬ã‚¤ãƒ³ã‚ºã‚¦ã‚©ãƒ¼ã‚«ãƒ¼ Â· æ°¸é ã®å¹´é½¢ Â· ãƒˆãƒ¼ãƒ³: å³ç²›",
                quote: "ã€Œã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯ã‚·ã‚¹ãƒ†ãƒ ã®ãƒã‚°ã§ã¯ãªã„ã€‚ãã‚Œã¯å®šå‘½ã®è€…ãŒæŒã¤å”¯ä¸€ã®ç¢ºå®Ÿæ€§ã§ã‚ã‚Š...ç§ã®å”¯ä¸€ã®é“å…·ã ã€‚ã€",
                bio_title: "çµŒæ­´: è™šç©ºã®ç›®æ’ƒè€…",
                bio_origin_tag: "ğŸŒŒ èµ·æº",
                bio_text: "ã‚¢ã‚ºãƒ©ã‚¨ãƒ«ã¯ç¥ã€…ãŒå˜˜ã‚’ã¤ãã“ã¨ã‚’å­¦ã¶å‰ã‹ã‚‰å­˜åœ¨ã—ã¦ã„ãŸã€‚æœ€åˆã®æ˜Ÿã®å´©å£Šã«ã‚ˆã£ã¦ç›®è¦šã‚ã€æ¬¡å…ƒã®é–“ã‚’å½·å¾¨ã„ã€æ˜Ÿé–“å¸å›½ã®èˆˆäº¡ã‚’è¦³å¯Ÿã—ã¦ã„ã‚‹ã€‚å½¼ã¯è‹±é›„ã§ã‚‚æ‚ªå…šã§ã‚‚ãªã„ã€‚å—è‚‰ã—ãŸ<strong>è‡ªç„¶ã®åŠ›</strong>ãã®ã‚‚ã®ã§ã‚ã‚‹ã€‚",
                bio_trauma_tag: "ğŸ©¸ ãƒˆãƒ©ã‚¦ãƒ",
                bio_trauma_text: "æœ€è¿‘ã€é»’è“®æ•™å›£ã®å„€å¼ã®å¤±æ•—ã«ã‚ˆã‚Šã€åŠå®šå‘½ã®è‚‰ä½“ã«ç¸›ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸã€‚å½¼ã¯åˆã‚ã¦è‚‰ä½“çš„ãªç—›ã¿ã¨é™ç•Œã‚’ç™ºè¦‹ã—ãŸã€‚",
                matrix: [
                    { label: "å˜˜", text: "ã€Œç§ã¯ã“ã®è‚‰ä½“ã®å›šäººã ã€‚ã€" },
                    { label: "å‚·", text: "æœ‰é™æ€§ã®æ„Ÿè¦šã€‚" },
                    { label: "æ¬²æœ›", text: "7ã¤ã®å°å°ã‚’ç ´ã‚‹ã€‚" }
                ],
                crisis_log: "ä¿è­·ãªã—ã§ãƒãƒŠçˆ†ç™ºã‚’æŠ‘ãˆè¾¼ã‚‚ã†ã¨ã—ãŸã€‚å·¦æ‰‹ã®æ„Ÿè¦šã‚’å¤±ã£ãŸã€‚<br><strong style='font-size:0.8rem; color:#d88'>>> ã‚¢ãƒ³ãƒ­ãƒƒã‚¯: ç†±è€æ€§</strong>",
                inventory_items: ["âš”ï¸ äº‹è±¡ã®å‰£", "ğŸ§¥ è™šç©ºã®ãƒãƒ³ãƒˆ", "ğŸ’ ç‰¹ç•°ç‚¹ã®æŒ‡è¼ª", "ğŸ“œ èµ·æºã®ã‚°ãƒªãƒ¢ãƒ¯ãƒ¼ãƒ«", "ğŸ©¸ å¤ä»£ã®è¡€ã®å°ç“¶", "ğŸ”‘ å¡”ã®éµ"]
            }
        };

        // --- SECURITY CORE ---
        function initSecureSystem() {
            try {
                // 1. DETECT LANGUAGE
                const hash = window.location.hash.replace('#', '');
                const lang = (hash && ['en', 'jp'].includes(hash)) ? hash : 'es';
                const t = TRANSLATIONS[lang];

                // 2. APPLY STATIC TEXTS
                document.title = t.title;
                document.querySelector('.tension-label-mini').innerText = t.tension_label;
                document.querySelector('.tension-wrapper div:nth-child(3)').innerHTML = t.tension_status;
                document.querySelector('.economy-box div:first-child').innerText = t.capital_label;
                document.querySelector('.scars-title').innerText = t.scars_title;

                // Scars
                const scarSlot = document.querySelector('.scar-slot.filled div');
                if (scarSlot) {
                    scarSlot.querySelector('span:nth-child(1)').innerText = t.scar_1;
                    scarSlot.querySelector('span:nth-child(2)').innerText = t.scar_1_sub;
                }
                const emptySlot = document.querySelectorAll('.scar-slot')[1];
                if (emptySlot) emptySlot.querySelector('span:first-child').innerText = t.scar_empty;

                // Stats Names
                const statNames = document.querySelectorAll('.stat-name-tiny');
                t.stats.forEach((s, i) => { if (statNames[i]) statNames[i].innerText = s; });

                // Dones
                document.querySelector('.resonance-title').innerText = t.dones_title;
                const perkLocked = document.querySelector('.locked-perk');
                perkLocked.querySelector('span:first-child').innerText = t.perk_locked_name;
                perkLocked.querySelector('.locked-msg').innerText = t.perk_locked_req;

                const perkActive = document.querySelector('.soul-perk:not(.locked-perk)');
                perkActive.querySelector('.perk-name').innerText = t.perk_active_name;
                perkActive.querySelector('div').innerText = t.perk_active_desc;

                // Content Areas
                document.getElementById('char-name').innerText = t.char_name;
                document.getElementById('tier-badge').innerText = t.tier;
                document.getElementById('char-archetype').innerText = t.archetype;
                document.querySelector('.quote-box').innerText = t.quote;

                document.querySelector('h2').innerText = t.bio_title;
                const bioPars = document.querySelectorAll('.main-content > p');
                // Bio P1
                const tag1 = bioPars[0].querySelector('.dm-tag');
                tag1.innerText = t.bio_origin_tag;
                // Preserve tag and append text
                bioPars[0].innerHTML = '';
                bioPars[0].appendChild(tag1);
                bioPars[0].insertAdjacentHTML('beforeend', " " + t.bio_text);

                // Bio P2
                const tag2 = bioPars[1].querySelector('.dm-tag');
                tag2.innerText = t.bio_trauma_tag;
                bioPars[1].innerHTML = '';
                bioPars[1].appendChild(tag2);
                bioPars[1].insertAdjacentHTML('beforeend', " " + t.bio_trauma_text);

                // Matrix
                const matrixRows = document.querySelectorAll('.matrix-row');
                t.matrix.forEach((m, i) => {
                    if (matrixRows[i]) {
                        matrixRows[i].querySelector('.matrix-label').innerText = m.label;
                        matrixRows[i].querySelector('.matrix-text').innerText = m.text;
                    }
                });

                // Inventory & Logs
                document.querySelector('h2:nth-of-type(2)').innerText = t.inv_title;
                document.querySelector('h2:nth-of-type(3)').innerText = t.crisis_title;
                document.querySelector('.main-content > div[style*="font-style:italic"]').innerText = t.crisis_subtitle;
                document.querySelector('.timeline-content').innerHTML = t.crisis_log;
                document.querySelector('.download-btn').innerText = t.btn_save;


                // 3. POPULATE SECURED DATA (Inventory & Stats)
                const securedData = {
                    stats: [18, 20, 22, 25, 25, 30], // STR, DEX, CON, INT, WIS, CHA
                    mods: ["+4", "+5", "+6", "+7", "+7", "+10"],
                    inventory: t.inventory_items // Use translated inventory
                };

                // ENFORCE STATS
                const statIds = ['str', 'dex', 'con', 'int', 'wis', 'cha'];
                statIds.forEach((id, index) => {
                    document.getElementById('stat-' + id).innerText = securedData.stats[index];
                    document.getElementById('mod-' + id).innerText = securedData.mods[index];
                });

                // ENFORCE INVENTORY
                const invGrid = document.getElementById('inventory-grid');
                if (invGrid) {
                    invGrid.innerHTML = '';
                    securedData.inventory.forEach(item => {
                        const div = document.createElement('div');
                        div.className = item.includes('âš”ï¸') || item.includes('ğŸ§¥') || item.includes('ğŸ’') ? 'inv-item legendary-item' : 'inv-item';
                        div.innerText = item;
                        invGrid.appendChild(div);
                    });
                }

                console.log("System Integrity Verified: Stats Locked (" + lang + ").");

            } catch (e) {
                console.error("Tampering Detected:", e);
                // document.body.innerHTML = "<h1 style='color:red; text-align:center; margin-top:50px;'>ERROR DE INTEGRIDAD</h1>";
            }
        }

        function saveProgress() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: "text/html;charset=utf-8" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "Azraell_Sheet.html";
            document.body.appendChild(a); a.click(); a.remove();
        }

        function encodeImageFileAsURL(element) {
            var file = element.files[0];
            var reader = new FileReader();
            reader.onloadend = function () {
                document.querySelector('.avatar-container').innerHTML = `<img src="${reader.result}" class="avatar-img">`;
            }
            reader.readAsDataURL(file);
        }
        function triggerUpload() { document.getElementById('avatar-input').click(); }
    </script>
</body>

</html>