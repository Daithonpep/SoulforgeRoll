<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Muro de los Ca√≠dos - Registro de Almas</title>
    <style>
        /* wall-of-fallen.css */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500&display=swap');

        body {
            margin: 0;
            font-family: 'Cormorant Garamond', serif;
            background-color: #0a0806;
            color: #e0e0e0;
        }

        .fallen-wall {
            min-height: 100vh;
            background:
                linear-gradient(to bottom,
                    rgba(10, 8, 6, 0.95),
                    rgba(20, 15, 10, 0.9)),
                url('/assets/stone-texture.jpg');
            /* Ensure this asset exists or use color */
            padding: 40px 20px;
        }

        .wall-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .wall-header h1 {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            color: #c9a959;
            text-shadow: 0 0 30px rgba(201, 169, 89, 0.3);
            margin-bottom: 10px;
            animation: header-glow 4s ease-in-out infinite;
        }

        @keyframes header-glow {

            0%,
            100% {
                text-shadow: 0 0 30px rgba(201, 169, 89, 0.3);
            }

            50% {
                text-shadow: 0 0 50px rgba(201, 169, 89, 0.5);
            }
        }

        .wall-subtitle {
            color: #8a7a6a;
            font-style: italic;
            font-size: 1.2rem;
        }

        /* Grid de ca√≠dos */
        .fallen-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Carta de h√©roe ca√≠do */
        .fallen-card {
            background: linear-gradient(135deg,
                    rgba(30, 25, 20, 0.95),
                    rgba(20, 15, 10, 0.98));
            border: 1px solid rgba(201, 169, 89, 0.2);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .fallen-card:hover {
            transform: translateY(-5px);
            box-shadow:
                0 10px 40px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(201, 169, 89, 0.1);
        }

        /* Retrato con vi√±eta de muerte */
        .fallen-portrait {
            position: relative;
            height: 200px;
            overflow: hidden;
            background-color: #1a1510;
        }

        .portrait-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: grayscale(0.7) sepia(0.3);
            transition: filter 0.5s ease;
        }

        .fallen-card:hover .portrait-img {
            filter: grayscale(0.4) sepia(0.2);
        }

        .death-vignette {
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at center,
                    transparent 30%,
                    rgba(0, 0, 0, 0.7) 100%);
            pointer-events: none;
        }

        /* Informaci√≥n */
        .fallen-info {
            padding: 20px;
        }

        .fallen-name {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: #e8e2d9;
            margin: 0 0 5px 0;
        }

        .fallen-title {
            color: #c9a959;
            font-style: italic;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .fallen-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(201, 169, 89, 0.1);
        }

        .fallen-stats .stat {
            color: #8a7a6a;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
            font-family: 'Inter', sans-serif;
        }

        .death-info {
            margin-bottom: 15px;
        }

        .death-cause {
            color: #a05050;
            font-weight: 500;
        }

        .death-location {
            color: #6a6a6a;
            font-size: 0.9rem;
        }

        /* √öltimas palabras */
        .last-words {
            background: rgba(0, 0, 0, 0.3);
            border-left: 3px solid #c9a959;
            padding: 15px;
            margin: 15px 0;
            font-style: italic;
            color: #b0a090;
        }

        .last-words::before {
            content: '"';
            font-size: 2rem;
            color: #c9a959;
            opacity: 0.5;
            line-height: 0;
            vertical-align: -0.4em;
        }

        /* Vela conmemorativa */
        .candle-container {
            position: absolute;
            bottom: 20px;
            right: 20px;
        }

        .candle {
            width: 8px;
            height: 40px;
            background: linear-gradient(to bottom, #f5e6c8 0%, #d4a847 100%);
            border-radius: 2px 2px 0 0;
            position: relative;
        }

        .flame {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 20px;
            background: radial-gradient(ellipse at bottom,
                    #fff7e6 0%,
                    #ffd93d 30%,
                    #ff6b35 60%,
                    transparent 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: flicker 0.5s ease-in-out infinite alternate;
            filter: blur(1px);
        }

        @keyframes flicker {
            0% {
                transform: translateX(-50%) scale(1) rotate(-2deg);
                opacity: 1;
            }

            100% {
                transform: translateX(-50%) scale(1.1) rotate(2deg);
                opacity: 0.9;
            }
        }

        /* Resplandor de la vela */
        .candle::after {
            content: '';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: radial-gradient(circle,
                    rgba(255, 200, 100, 0.2) 0%,
                    transparent 70%);
            animation: glow-pulse 2s ease-in-out infinite;
        }

        @keyframes glow-pulse {

            0%,
            100% {
                opacity: 0.5;
                transform: translateX(-50%) scale(1);
            }

            50% {
                opacity: 0.8;
                transform: translateX(-50%) scale(1.2);
            }
        }
    </style>
</head>

<body>

    <div class="fallen-wall" id="fallen-wall">
        <header class="wall-header">
            <h1>‚ö∞Ô∏è Muro de los Ca√≠dos</h1>
            <p class="wall-subtitle">En memoria de aquellos que dieron su vida</p>
        </header>

        <div class="fallen-grid" id="fallen-grid">
            <!-- Se llena din√°micamente -->
        </div>
    </div>

    <template id="fallen-card-template">
        <article class="fallen-card" data-soul-id="">
            <div class="fallen-portrait">
                <img src="" alt="" class="portrait-img">
                <div class="death-vignette"></div>
            </div>

            <div class="fallen-info">
                <h2 class="fallen-name"></h2>
                <p class="fallen-title"></p>

                <div class="fallen-stats">
                    <span class="stat">
                        <i>‚öîÔ∏è</i>
                        <span class="kills-count"></span> ca√≠dos
                    </span>
                    <span class="stat">
                        <i>üìÖ</i>
                        <span class="sessions-count"></span> sesiones
                    </span>
                    <span class="stat">
                        <i>üéÇ</i>
                        <span class="age-count"></span> a√±os
                    </span>
                </div>

                <div class="death-info">
                    <p class="death-cause"></p>
                    <p class="death-location"></p>
                </div>

                <blockquote class="last-words"></blockquote>

                <div class="fallen-memories">
                    <!-- Memorias definitorias -->
                </div>
            </div>

            <div class="candle-container">
                <div class="candle">
                    <div class="flame"></div>
                </div>
            </div>
        </article>
    </template>

    <script>
        // wall-of-fallen.js

        class WallOfFallen {
            constructor() {
                this.grid = document.getElementById('fallen-grid');
                this.template = document.getElementById('fallen-card-template');
                this.loadFallen();
            }

            async loadFallen() {
                try {
                    // Mock data for display if API not connected yet
                    // To actually connect, ensure API endpoint exists
                    const response = await fetch('/api/wall-of-fallen');
                    if (!response.ok) throw new Error("API not available");
                    const fallen = await response.json();

                    this.renderFallen(fallen);
                } catch (error) {
                    console.warn('Error loading fallen heroes, using mock data:', error);
                    this.renderFallen([
                        {
                            id: 'mock-1',
                            name: 'Thaeon el Valiente',
                            title: 'Escudo del Norte',
                            kills_total: 142,
                            sessions_played: 12,
                            age_years: 34,
                            death_cause: 'Sacrificio contra el Drag√≥n de Hielo',
                            death_location: 'Pico Tormenta',
                            last_words: 'Protech el reino...',
                            portrait_url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Thaeon'
                        },
                        {
                            id: 'mock-2',
                            name: 'Lyra Sombraveloz',
                            title: 'La Daga Invisible',
                            kills_total: 89,
                            sessions_played: 24,
                            age_years: 29,
                            death_cause: 'Veneno de Wyvern',
                            death_location: 'Pantanos de Hueso',
                            last_words: null,
                            portrait_url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Lyra'
                        }
                    ]);
                }
            }

            renderFallen(fallen) {
                this.grid.innerHTML = '';

                fallen.forEach((hero, index) => {
                    const card = this.createCard(hero);

                    // Animaci√≥n escalonada de entrada
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';

                    this.grid.appendChild(card);

                    setTimeout(() => {
                        card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, index * 100);
                });
            }

            createCard(hero) {
                const clone = this.template.content.cloneNode(true);
                const card = clone.querySelector('.fallen-card');

                card.dataset.soulId = hero.id;

                // Llenar datos
                card.querySelector('.fallen-name').textContent = hero.name;
                card.querySelector('.fallen-title').textContent = hero.title || 'Aventurero';
                card.querySelector('.kills-count').textContent = hero.kills_total || 0;
                card.querySelector('.sessions-count').textContent = hero.sessions_played || 0;
                card.querySelector('.age-count').textContent = hero.age_years || '?';

                card.querySelector('.death-cause').textContent = hero.death_cause || 'Causa desconocida';
                card.querySelector('.death-location').textContent =
                    hero.death_location ? `üìç ${hero.death_location}` : '';

                if (hero.last_words) {
                    card.querySelector('.last-words').textContent = hero.last_words;
                } else {
                    card.querySelector('.last-words').style.display = 'none';
                }

                // Retrato (placeholder si no hay)
                const portrait = card.querySelector('.portrait-img');
                portrait.src = hero.portrait_url || `https://api.dicebear.com/7.x/avataaars/svg?seed=${hero.name}`;
                portrait.alt = hero.name;

                // Click para ver detalle
                card.addEventListener('click', () => this.showDetail(hero.id));

                return card;
            }

            async showDetail(soulId) {
                // Modal con historia completa
                // const response = await fetch(`/api/wall-of-fallen/${soulId}`);
                // const detail = await response.json();

                // Crear modal...
                console.log('Show detail for:', soulId);
                this.openDetailModal({ id: soulId });
            }

            openDetailModal(hero) {
                // Implementar modal con:
                // - Historia completa
                // - Todas las memorias
                // - L√≠nea de tiempo
                // - Linaje
                // - Artefactos que dej√≥
                console.log('Detail:', hero);
                alert("Detalle del h√©roe (Feature en desarrollo)");
            }
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', () => {
            new WallOfFallen();
        });
    </script>
</body>

</html>